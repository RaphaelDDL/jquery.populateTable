/*
 * jQuery populateTable v0.1.4
 * http://raphaelddl.com
 * 
 * Copyright (c) 2012 Raphael "DDL" Oliveira
 * Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License (CC BY-NC-SA 3.0) 
 * http://creativecommons.org/licenses/by-nc-sa/3.0/
 */
(function($){$.fn.extend({populateTable:function(dataToInsert,options){var defaults={tableSorter:{applyTS:!1,tableSorterOpt:null},tableHeads:null,tablePreCallback:null,tableCallback:null,tableData:{emptyMsg:"No data available.",dataRoot:null,dataRepeat:null}},options=$.extend(defaults,options);return this.each(function(){var dataObj,dataRt,dataInfo,dataValues,tableIsEmpty,preCallbackFnk,o=options,theTable=$(this),headList="",footList="",finalHeader="",tableInsertData="",dataInserted="";$.type(o.tableHeads)=="object"&&($.each(o.tableHeads.values,function(a){var b=o.tableHeads.values[a].headText;headList=headList+"<th>"+b+"</th>",footList=footList+"<th>"+b+"</th>"}),finalHeader="<thead><tr>"+headList+"</tr>"+"</thead>"+"<tfoot>"+"<tr>"+footList+"</tr>"+"</tfoot>");if($.type(dataToInsert)=="object"){dataObj=dataToInsert,dataRt=o.tableData.dataRoot,dataInfo=dataObj[dataRt],dataValues=o.tableData.dataRepeat.values;if($.type(dataInfo)!="null")tableInsertData="<tbody>",o.tableHeads.values.length!=o.tableData.dataRepeat.values.length&&(tableInsertData=tableInsertData+'<tr><td style="vertical-align:middle;text-align:center;" colspan="'+o.tableHeads.values.length+'">WARNING: Number of headers ('+o.tableHeads.values.length+") differs from number of data columns ("+o.tableData.dataRepeat.values.length+").<br />Check your script again.</td></tr>"),$.each(dataInfo,function(rowInd){tableInsertData=tableInsertData+'<tr id="'+dataRt+"-r"+rowInd+'">',$.each(dataValues,function(valInd,dtVal){var regToFind,regResult,dataValueInserted,insertEmpty=dtVal.emptyTxt,dataContents=dtVal.fieldTxt;if($.type(dataContents)=="string"&&$.type(dataContents)!="null"){regToFind=/%\{(.*?)\}/ig,regResult=dataContents.match(regToFind);$.each(regResult,function(indx,foundField){var toReplaceWith,dataField=foundField.replace(regToFind,"$1"),checkChild=dataField.split(".");if(checkChild.length>1){toReplaceWith="dataInfo[rowInd]";for(i=0;i<checkChild.length;i++)toReplaceWith=toReplaceWith+"['"+checkChild[i]+"']";toReplaceWith=eval(toReplaceWith)}else toReplaceWith=dataInfo[rowInd][dataField];$.type(toReplaceWith)!="null"&&$.type(toReplaceWith)!="object"?dataContents=dataContents.replace(foundField,toReplaceWith):dataContents=dataContents.replace(foundField,insertEmpty)});dataValueInserted=dataContents}tableInsertData=tableInsertData+'<td id="'+dataRt+"-r"+rowInd+"-c"+valInd+'">',tableInsertData+=dataValueInserted,tableInsertData+="</td>"}),tableInsertData+="</tr>"}),tableInsertData+="</tbody>";else{tableIsEmpty='<tbody><tr><td style="vertical-align:middle;text-align:center;" colspan="'+o.tableHeads.values.length+'">'+o.tableData.emptyMsg+"</td></tr></tbody>";$(theTable).append(tableIsEmpty)}}$.type(dataToInsert)!="null"&&($(theTable).html(""),$(theTable).prepend(finalHeader),$(theTable).append(tableInsertData));if($.type(o.tablePreCallback)!="null"&&$.type(o.tablePreCallback.tbCb)=="function"){preCallbackFnk=o.tablePreCallback.tbCb;preCallbackFnk.call(this)}setTimeout(function(){var a;$(theTable).find("tbody").find("tr").size()>0?$.type(o.tableSorter)=="object"&&o.tableSorter.applyTS==1&&($.type(o.tableSorterOpt)=="object"?$(theTable).tablesorter(o.tableSorterOpt):$(theTable).tablesorter()):$(theTable).append('<tbody><tr><td style="vertical-align:middle;text-align:center;" colspan="'+o.tableHeads.values.length+'">'+o.tableData.emptyMsg+"</td></tr></tbody>");if($.type(o.tableCallback)!="null"&&$.type(o.tableCallback.tbCb)=="function"){a=o.tableCallback.tbCb;a.call(this)}},1)})}})})(jQuery)